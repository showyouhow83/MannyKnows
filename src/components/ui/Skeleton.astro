---
// Skeleton loading component for better perceived performance
// Used while dynamic content is loading

interface Props {
  variant?: 'text' | 'card' | 'button' | 'avatar' | 'toggle';
  width?: string;
  height?: string;
  className?: string;
  count?: number;
}

const { 
  variant = 'text', 
  width = '100%', 
  height = '1rem', 
  className = '',
  count = 1
} = Astro.props;

const getSkeletonClass = (variant: string) => {
  const baseClass = 'animate-pulse bg-gray-200 dark:bg-gray-700 rounded';
  
  switch (variant) {
    case 'text':
      return `${baseClass} h-4`;
    case 'card':
      return `${baseClass} h-32`;
    case 'button':
      return `${baseClass} h-10`;
    case 'avatar':
      return `${baseClass} rounded-full w-8 h-8`;
    case 'toggle':
      return `${baseClass} w-11 h-6 rounded-full`;
    default:
      return baseClass;
  }
};
---

{Array.from({ length: count }).map(() => (
  <div 
    class={`${getSkeletonClass(variant)} ${className}`}
    style={`width: ${width}; height: ${height};`}
    aria-hidden="true"
  />
))}

<style>
  @keyframes pulse {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }
  
  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }
  
  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .animate-pulse {
      animation: none;
      opacity: 0.5;
    }
  }
</style>
