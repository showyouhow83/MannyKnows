---
import PostHogAdvanced from '../components/analytics/PostHogAdvanced.astro';
import SettingsModal from '../components/SettingsModal.astro';
import FooterMain from '../components/footer/FooterMain.astro';

export interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="MannyKnows - Professional AI-powered business solutions. Transform your business with intelligent automation, data-driven insights, and cutting-edge AI services." />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		
		<!-- Apple-style System Font Stack -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
		
		<!-- Analytics -->
		<PostHogAdvanced />
		
		<!-- Pixel Canvas Effect -->
		<script type="module" src="/pixel-canvas.js"></script>
		
		<title>{title}</title>
		
		<!-- Theme initialization script - must run before body to prevent FOUC -->
		<script>
			// Initialize theme immediately to prevent flash of unstyled content
			(function() {
				// Default to dark mode unless explicitly set to light
				const themeDark = localStorage.getItem('theme-dark') !== 'false';
				
				if (themeDark) {
					document.documentElement.classList.add('dark');
				} else {
					document.documentElement.classList.remove('dark');
				}
			})();
		</script>
	</head>
	<body>
		<!-- Settings Modal -->
		<SettingsModal />
		
		<slot />
		
		<FooterMain />
	</body>
</html>

<style is:global>
	:root {
		/* Apple-inspired Font System */
		--bs-body-font-family: 'SF Pro Display', 'SF Pro Icons', 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", "Noto Sans", "Liberation Sans", Arial, sans-serif;
		--bs-font-family-heading: 'SF Pro Display', 'Inter', sans-serif;
		--bs-body-font-size: 1rem;
		--bs-body-font-weight: 400;
		--bs-body-line-height: 1.1666666667;
		--bs-body-color: #ffffff;
		--bs-body-bg: #1b1c1e;
		--bs-body-text-align: left;
		
		/* Apple-style Typography Variables - Light Theme */
		--sk-body-text-color: rgb(29,29,31);
		--sk-headline-text-color: rgb(29,29,31);
		--sk-body-background-color: rgb(255,255,255);
		--sk-body-font-stack: text;
		--sk-focus-color: #0071e3;
		--sk-focus-color-alt: rgb(0,0,0);
		--sk-focus-offset: 1px;
		
		/* Apple-style Grays - Light Theme */
		--sk-glyph-gray: rgb(29,29,31);
		--sk-glyph-gray-secondary: rgb(110,110,115);
		--sk-glyph-gray-tertiary: rgb(134,134,139);
		--sk-fill-secondary: rgb(250,250,252);
		--sk-fill-tertiary: rgb(245,245,247);
		--sk-fill-gray-quaternary: rgb(232,232,237);
		
		/* Border Colors - Light Theme */
		--border-light: rgba(0, 0, 0, 0.1);
		--border-light-hover: rgba(0, 0, 0, 0.2);
		--border-dark: rgba(255, 255, 255, 0.1);
		--border-dark-hover: rgba(255, 255, 255, 0.2);
		
		/* Text Colors - Light Theme */
		--text-light-primary: rgb(29, 29, 31);
		--text-dark-primary: rgba(255, 255, 255, 0.95);
		
		/* Typography Enhancement */
		letter-spacing: .009em;
		font-synthesis: none;
		-webkit-font-smoothing: antialiased;
		text-rendering: optimizeLegibility;
	}

	/* Dark theme Apple variables */
	:root.dark {
		/* Apple-style Typography Variables - Dark Theme */
		--sk-body-text-color: rgba(255,255,255,0.85);
		--sk-headline-text-color: rgba(255,255,255,0.95);
		--sk-body-background-color: rgb(28,28,30);
		--sk-focus-color: #0071e3;
		--sk-focus-color-alt: rgba(255,255,255,0.9);
		
		/* Apple-style Grays - Dark Theme */
		--sk-glyph-gray: rgba(255,255,255,0.95);
		--sk-glyph-gray-secondary: rgba(255,255,255,0.68);
		--sk-glyph-gray-tertiary: rgba(255,255,255,0.55);
		--sk-fill-secondary: rgb(44,44,46);
		--sk-fill-tertiary: rgb(58,58,60);
		--sk-fill-gray-quaternary: rgb(72,72,74);
	}

	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}

	html {
		scroll-behavior: smooth;
		height: 100%;
	}

	body {
		margin: 0;
		font-family: var(--bs-body-font-family);
		font-size: var(--bs-body-font-size);
		font-weight: var(--bs-body-font-weight);
		line-height: var(--bs-body-line-height);
		color: var(--bs-body-color);
		text-align: var(--bs-body-text-align);
		background-color: var(--bs-body-bg);
		-webkit-text-size-adjust: 100%;
		-webkit-tap-highlight-color: rgba(0,0,0,0);
		-webkit-font-smoothing: antialiased;
		font-synthesis: none;
		text-rendering: optimizeLegibility;
		letter-spacing: .009em;
		height: 100%;
	}

	/* Apple System Font Classes */
	.sf-light {
		font-family: "SF Pro Display", "Inter", sans-serif;
		font-optical-sizing: auto;
		font-weight: 300;
		font-style: normal;
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
	}

	.sf-regular {
		font-family: "SF Pro Display", "Inter", sans-serif;
		font-optical-sizing: auto;
		font-weight: 400;
		font-style: normal;
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
	}

	.sf-medium {
		font-family: "SF Pro Display", "Inter", sans-serif;
		font-optical-sizing: auto;
		font-weight: 500;
		font-style: normal;
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
	}

	.sf-semibold {
		font-family: "SF Pro Display", "Inter", sans-serif;
		font-optical-sizing: auto;
		font-weight: 600;
		font-style: normal;
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
	}

	.sf-bold {
		font-family: "SF Pro Display", "Inter", sans-serif;
		font-optical-sizing: auto;
		font-weight: 700;
		font-style: normal;
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
	}

	.sf-extrabold {
		font-family: "SF Pro Display", "Inter", sans-serif;
		font-optical-sizing: auto;
		font-weight: 800;
		font-style: normal;
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
	}

	.sf-black {
		font-family: "SF Pro Display", "Inter", sans-serif;
		font-optical-sizing: auto;
		font-weight: 900;
		font-style: normal;
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
	}

	/* Apply Apple-style typography to all headings */
	h1, h2, h3, h4, h5, h6 {
		font-family: var(--bs-font-family-heading);
		-webkit-font-smoothing: antialiased;
		letter-spacing: .009em;
		font-optical-sizing: auto;
		font-style: normal;
	}

	/* Utility classes */
	.container {
		max-width: 1440px;
		margin: 0 auto;
		padding: 0 2rem;
	}

	/* Service box padding */
	.service-box-padding {
		padding: 1rem;
	}

	/* Only keep the specific utility we actually use */
	.max-w-chat {
		max-width: 75%;
	}

	/* Subtle gradient border animation with ultra-smooth color transition */
	.animate-gradient-slide {
		background: linear-gradient(90deg, transparent, #10d1ff, transparent);
		background-size: 200% 100%;
		animation: gradient-slide-color 30s ease-in-out infinite;
	}

	@keyframes gradient-slide-color {
		0% {
			background: linear-gradient(90deg, transparent, #10d1ff, transparent);
			background-position: 0% 50%;
		}
		5% {
			background: linear-gradient(90deg, transparent, #10d1ff, transparent);
			background-position: 50% 50%;
		}
		10% {
			background: linear-gradient(90deg, transparent, #10d1ff, transparent);
			background-position: 100% 50%;
		}
		15% {
			background: linear-gradient(90deg, transparent, #20c9ff, transparent);
			background-position: 100% 50%;
		}
		20% {
			background: linear-gradient(90deg, transparent, #30c1ff, transparent);
			background-position: 50% 50%;
		}
		25% {
			background: linear-gradient(90deg, transparent, #40b9ff, transparent);
			background-position: 0% 50%;
		}
		30% {
			background: linear-gradient(90deg, transparent, #50b1ff, transparent);
			background-position: 0% 50%;
		}
		35% {
			background: linear-gradient(90deg, transparent, #60a9ff, transparent);
			background-position: 50% 50%;
		}
		40% {
			background: linear-gradient(90deg, transparent, #70a1ff, transparent);
			background-position: 100% 50%;
		}
		45% {
			background: linear-gradient(90deg, transparent, #8099ff, transparent);
			background-position: 100% 50%;
		}
		50% {
			background: linear-gradient(90deg, transparent, #9091ff, transparent);
			background-position: 50% 50%;
		}
		55% {
			background: linear-gradient(90deg, transparent, #a089ff, transparent);
			background-position: 0% 50%;
		}
		60% {
			background: linear-gradient(90deg, transparent, #b081ff, transparent);
			background-position: 0% 50%;
		}
		65% {
			background: linear-gradient(90deg, transparent, #c079ff, transparent);
			background-position: 50% 50%;
		}
		70% {
			background: linear-gradient(90deg, transparent, #d071ff, transparent);
			background-position: 100% 50%;
		}
		75% {
			background: linear-gradient(90deg, transparent, #e069dd, transparent);
			background-position: 100% 50%;
		}
		80% {
			background: linear-gradient(90deg, transparent, #f061bb, transparent);
			background-position: 50% 50%;
		}
		85% {
			background: linear-gradient(90deg, transparent, #ff5999, transparent);
			background-position: 0% 50%;
		}
		90% {
			background: linear-gradient(90deg, transparent, #ff51aa, transparent);
			background-position: 0% 50%;
		}
		95% {
			background: linear-gradient(90deg, transparent, #ff4faa, transparent);
			background-position: 50% 50%;
		}
		100% {
			background: linear-gradient(90deg, transparent, #10d1ff, transparent);
			background-position: 0% 50%;
		}
	}

	/* Dark gradient animation for footer background */
	.animate-gradient-flow {
		background-size: 400% 400%;
		animation: gradient-flow 8s ease-in-out infinite;
	}

	@keyframes gradient-flow {
		0% {
			background-position: 0% 50%;
		}
		25% {
			background-position: 100% 50%;
		}
		50% {
			background-position: 100% 50%;
		}
		75% {
			background-position: 0% 50%;
		}
		100% {
			background-position: 0% 50%;
		}
	}

	/* Apple-style Typography Classes */
	.apple-headline {
		line-height: 1.1666666667;
		font-weight: 650;
		letter-spacing: -.009em;
		-webkit-font-smoothing: antialiased;
		text-rendering: optimizeLegibility;
		color: var(--sk-headline-text-color);
	}

	.apple-body-text {
		line-height: 1.2666666667;
		letter-spacing: -.009em;
		-webkit-font-smoothing: antialiased;
		text-rendering: optimizeLegibility;
		color: var(--sk-body-text-color);
	}

	.apple-gradient-text {
		background: linear-gradient(45deg, #0071e3, #ff4faa, #10d1ff);
		background-size: 200% 200%;
		-webkit-background-clip: text;
		background-clip: text;
		-webkit-text-fill-color: transparent;
		animation: apple-gradient-flow 15s ease-in-out infinite;
	}

	.apple-gradient-container {
		position: relative;
		/* Remove forced background, let theme handle it */
	}

	/* Apple-style Button Enhancements */
	.apple-button {
		font-family: var(--bs-font-family-heading);
		font-weight: 600;
		letter-spacing: .009em;
		-webkit-font-smoothing: antialiased;
		border-radius: 12px;
		transition: all 0.25s ease;
		border: 1px solid transparent;
		position: relative;
		overflow: hidden;
	}

	.apple-button:hover {
		transform: translateY(-1px);
		box-shadow: 0 8px 25px rgba(0,0,0,0.15);
	}

	.apple-button:active {
		transform: translateY(0);
		box-shadow: 0 4px 12px rgba(0,0,0,0.1);
	}

	/* Apple Gradient Animation */
	@keyframes apple-gradient-flow {
		0%, 100% {
			background-position: 0% 50%;
		}
		50% {
			background-position: 100% 50%;
		}
	}

	/* Apple-style Focus States */
	.apple-focus:focus {
		outline: var(--sk-focus-offset) solid var(--sk-focus-color);
		outline-offset: var(--sk-focus-offset);
		box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.2);
	}

	/* Apple-style Card Effects */
	.apple-card {
		background: var(--sk-fill-secondary);
		border: 1px solid var(--sk-fill-gray-quaternary);
		border-radius: 12px;
		transition: all 0.25s ease;
	}

	.apple-card:hover {
		transform: translateY(-2px);
		box-shadow: 0 12px 30px rgba(0,0,0,0.12);
	}

	/* Dark theme overrides for Apple styles */
	@media (prefers-color-scheme: dark) {
		:root.dark .apple-headline {
			color: var(--sk-headline-text-color);
		}
		
		:root.dark .apple-body-text {
			color: var(--sk-body-text-color);
		}
		
		:root.dark .apple-card {
			background: rgba(255,255,255,0.05);
			border-color: rgba(255,255,255,0.1);
		}

		:root.dark .apple-gradient-container {
			background: transparent;
		}
	}

	/* Light theme specific styles */
	@media (prefers-color-scheme: light) {
		:root:not(.dark) .apple-headline {
			color: var(--sk-headline-text-color);
		}
		
		:root:not(.dark) .apple-body-text {
			color: var(--sk-body-text-color);
		}
		
		:root:not(.dark) .apple-card {
			background: var(--sk-fill-secondary);
			border-color: var(--sk-fill-gray-quaternary);
		}

		:root:not(.dark) .apple-gradient-container {
			background: transparent;
		}
	}

	/* 360° rotation animation for footer 360° Services icon */
	.hover\\:rotate-360:hover {
		transform: rotate(360deg);
	}
</style>
